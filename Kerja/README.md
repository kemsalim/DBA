## COMMON COMMAND
```bash
echo $ORACLE_SID
ls -la
. .[profile]

cd ~/mii/script/
```

```bash
sqlplus / as sysdba
!ls -lrth

SQL> @run_all_v2.sql
SQL> !crsctl stat res -t
```

```bash
top 
```

```bash
sh free_memory_percentage.sh
```

```bash
df -h
```

```bash
history | grep tail
```

```bash
CREATE TABLE employees (employee_id NUMBER GENERATED BY DEFAULT AS IDENTITY,first_name VARCHAR2(50),last_name VARCHAR2(50));
```

| Command  | Level  | Keterangan  |
| -------- | -------- | -------- |
| ```bash startup; ``` | SQL   | Untuk memulai instance pada Oracle Database   |
| ```bash SELECT name FROM v$database; ```  | SQL   | Menampilkan nama dari database yang tersedia   |
| ```bash DESCRIBE v$database; ```| SQL | Untuk menampilkan informasi dari kolom sebuah database |
| ```bash SELECT DBID, NAME, OPEN_MODE FROM v$database; ```| SQL | Menampilkan informasi ID Database, Nama, dan status akses edit |
| ```bash SELECT FILE#, NAME FROM v$datafile; ```| SQL | Menampilkan informasi direktori, dan nama dari datafile |
| ```bash SELECT df.NAME as "NAME DF", ts.NAME as "NAME TS" FROM v$datafile df INNER JOIN v$tablespace ts ON df.TS# = ts.TS#; ``` | SQL | Query Join untuk menampilkan informasi nama dan direktori nya berdasarkan join tabel datafile dengan tablespace dengan PK TS# |
| ```bash shutdown; shutdown immediate; ```| SQL | Jika hanya shutdown, harus di close session lain satu persatu. Immediate memaksa ter shutdown session lain juga. |
|  ```bash lsnrctl status ``` | SQL | Memeriksa apakah Listener sedang kondisi menyala  |
|  ```bash lsnrctl start ``` | SQL | Memulai listener |
|  ```bash cd/u01/app/oracle/product/19.0.0/db_1/network/admin/ls -lrth ``` | ORCL | Memeriksa listener mana saja yang aktif |
|  ```bash exit ``` | SQL | Untuk akhiri command session |
|  ```bash wq: ``` | ALL | Untuk save setelakukan perubahan pada file |
|  ```bash cd /u01/app/oracle/product/19.0.0/db_1/dbs ``` | DIR | Memeriksa file init.ora atau spfile.ora File ini terkait startup; |
| ```bash cd /u01/app/oracle/diag/rdbms/orcldb/orcl/trace/ ```| DIR | File alert.log memiliki peran penting dalam pemantauan dan pemecahan masalah database. Ini adalah file teks yang berisi catatan peristiwa (event) yang signifikan dan pesan kesalahan yang dihasilkan oleh Oracle Database.|
| ```bash CREATE TABLESPACE kemil DATAFILE '/u01/app/oracle/product/19.0.0/db_1/mydbfiles/ORCLDB/kemil.dbf' SIZE 100M; ```| SQL | Membuat tablespace baru dengan nama kemil pada datafile |
| ```bash CREATE USER dba_kemil IDENTIFIED BY kemil DEFAULT TABLESPACE kemil; ```| SQL | Membuat user baru dan set default user tersebut untuk tablespace kemil |
| ```bash ALTER USER dba_kemil DEFAULT TABLESPACE kemil; ```| SQL | Set default kembali dba_kemil sebagai DEFAULT user TABLESPACE |
| ```bash CREATE TABLE info_kemil (biodata VARCHAR(255)); ```| SQL | Membuat table baru |
| ```bash INSERT INTO info_kemil (biodata) VALUES ('Laki-laki'); ```| SQL | Insert data ke table info_kemil |
| ```bash SELECT SID, USER# FROM v$session WHERE blocking_session IS NOT NULL; ``` | SQL | Memeriksa apakah ada session yang terjadi locking |
| ```bash SHOW PARAMTER pfile; ```| SQL | Untuk melihat lokasi spfile, bisa memeriksa ukuran sharer pool atau memory target SGA |
| ```bash RMAN target=/ !RMAN target=/ ```| SQL | Masuk ke command RMAN |
| ```bash ALTER DATABASE ARCHIVELOG ```| SQL | Jika modenya masih NO LOG |
| ```bash archive log list; ```| SQL | Periksa status Archive Log |
| ```bash show pdbs; ```| SQL | Periksa ketersediaan PDB |
| ```bash connect sys@PDB1; ```| SQL | Untuk konak ke PDB1 |
| ```bash alter session set container = PDB1 ```| SQL | Untuk alter session ke PDB yang dipilih |
| ```bash show con_name; ```| SQL | Untuk cek ketersedian yang berhasil terkoneksi | 
| ```bashSELECT instance_name FROM v$instance; ```| SQL | Untuk cek nama SID |
| ```bashSELECT name FROM v$database; ```| SQL | Untuk cek nama Service Name dan Global DB Name |
| ```bash ALTER USER system IDENTIFIED BY "password" ACCOUNT UNLOCK; ```| SQL | Ganti password user |

## Test Backup Restore RMAN

Pre : ARCHIVELOG ON
```bash
RUN{
ALLOCATE CHANNEL c1 DEVICE TYPE disk;
ALLOCATE CHANNEL c2 DEVICE TYPE disk;
ALLOCATE CHANNEL c3 DEVICE TYPE disk;
ALLOCATE CHANNEL c4 DEVICE TYPE disk;
backup database format '/backup/restore_scn_sscrpt/backup_%U';
BACKUP AS BACKUPSET ARCHIVELOG ALL TAG 'ARCHIVELOG' FORMAT '/backup/restore_scn_sscrpt/ARC_%I-%d-%T_%s_%p.arch';
backup current controlfile for standby format '/backup/restore_scn_sscrpt/standby_controlfile_%s_%t.ctl';
backup current controlfile format '/backup/restore_scn_sscrpt/current_controlfile_%s_%t.ctl';
}
```
```bash
release channel c1;
release channel c2;
release channel c3;
release channel c4;
```

```bash
list backup;
list backup summary;
```
```bash
startup nomount;
ls -la ##pastikan nomor controlfile
restore controlfile from '/backup/restore_scn_sscrpt/current_controlfile_14_1142768992.ctl';
```
```bash
catalog start with '/backup/restore_scn_sscrpt/';
```
```bash
run{
ALLOCATE CHANNEL ch1 DEVICE TYPE disk;
ALLOCATE CHANNEL ch2 DEVICE TYPE disk;
ALLOCATE CHANNEL ch3 DEVICE TYPE disk;
ALLOCATE CHANNEL ch4 DEVICE TYPE disk;
restore database;
}
```
```bash
list archivelog all;
```

```bash
run{
ALLOCATE CHANNEL ch1 DEVICE TYPE disk;
ALLOCATE CHANNEL ch2 DEVICE TYPE disk;
ALLOCATE CHANNEL ch3 DEVICE TYPE disk;
ALLOCATE CHANNEL ch4 DEVICE TYPE disk;
set until sequence = 9; 
recover database;
release channel ch1;
release channel ch2;
release channel ch3;
release channel ch4;
}

#archivelog terakhir + 1
```
```bash
alter database open resetlogs;
```
## CONTOH REQ 1

Rekan MII,
Mohon bantuannya untuk backup/export table schema db EDWBI (DC1EDWDBO13/14) dibawah ini untuk kebutuhan audit
Format nya bisa liat di /backup1/dmp yang ada di dc1edwdbo13:
EDW_SIPU_BPK_ddmmyyyy
REKON_BPK_ddmmyyyy

1. Periksa dan pastikan Hostname
2. CD atau masuk ke folder Backup tujuan
3. Lakukan IMPDP Export

Contoh isi table:
- DWBI_DM.F_BISAK_PTTB_BPK,
- DWBI_DM.F_BISAK_TRANSAKSI_KAS_BPK,
- DWBI_DM.F_ERP_INVENTORY_BPK,
- DWBI_DM.F_ERP_INV_SHIPMENT_TRX_BPK,
- DWBI_DM.F_KI_AKT_BISAK_PTTB_BPK,
- DWBI_DM.F_KI_ERP_POSISI_AKUNTING_SIPU_BPK,
- DWBI_DM.F_KI_ERP_TRX_AKUNTING_SIPU_BPK

```bash
expdp system/oracle123@EDWBI directory=DATAPUMP tables=DWBI_DM.F_BISAK_PTTB_BPK,DWBI_DM.F_BISAK_TRANSAKSI_KAS_BPK,DWBI_DM.F_ERP_INVENTORY_BPK,DWBI_DM.F_ERP_INV_SHIPMENT_TRX_BPK,DWBI_DM.F_KI_AKT_BISAK_PTTB_BPK,DWBI_DM.F_KI_ERP_POSISI_AKUNTING_SIPU_BPK,DWBI_DM.F_KI_ERP_TRX_AKUNTING_SIPU_BPK estimate_only=yes logfile=estimate_table_EDW_SIPU_BPK_21072023.log
```
```bash
nohup expdp system/oracle123@EDWBI parfile=expd_EDW_SIPU_BPK.par &
```

Contoh isi table:

DWBI_DM.F_REKON_CLAIM_TANGGUNGAN_BPK,
DWBI_DM.F_REKON_COA_ERP_FMB_BPK,
DWBI_DM.F_REKON_DATA_PEG_TANGGUNGAN_BPK,
DWBI_DM.F_REKON_IN_OUT_MODAL_KERJA_DTL_BPK,
DWBI_DM.F_REKON_LOG_DATA_FMB_SOSA_BPK,
DWBI_DM.F_REKON_LOG_DATA_SOSA_ERP_BPK,
DWBI_DM.F_REKON_MODAL_KERJA_EOD_BPK,
DWBI_DM.F_REKON_MUSNAH_BISAK_VS_ERP_BPK,
DWBI_DM.F_REKON_MUTASI_EOD_BPK,
DWBI_DM.F_REKON_MUTASI_EOD_FMB_SOSA_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERPBISAK_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERPSOSA_BPK,
DWBI_DM.F_REKON_TRX_KAS_VS_MODAL_KERJA_BPK,
DWBI_DM.F_REKON_COA_ERP_CBS_BPK,
DWBI_DM.F_REKON_LOG_DATA_ERP_CBS_BPK,
DWBI_DM.F_REKON_STATUS_KRYWN_HRIS_CBS_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_CBS_FMB_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERP_CBS_BPK,
DWBI_DM.F_REKON_TRX_PAJAK_ERP_CBS_BPK

```bash
expdp system/oracle123@EDWBI directory=DATAPUMP tables=DWBI_DM.F_REKON_CLAIM_TANGGUNGAN_BPK,DWBI_DM.F_REKON_COA_ERP_FMB_BPK,DWBI_DM.F_REKON_DATA_PEG_TANGGUNGAN_BPK,DWBI_DM.F_REKON_IN_OUT_MODAL_KERJA_DTL_BPK,DWBI_DM.F_REKON_LOG_DATA_FMB_SOSA_BPK,DWBI_DM.F_REKON_LOG_DATA_SOSA_ERP_BPK,DWBI_DM.F_REKON_MODAL_KERJA_EOD_BPK,DWBI_DM.F_REKON_MUSNAH_BISAK_VS_ERP_BPK,DWBI_DM.F_REKON_MUTASI_EOD_BPK,DWBI_DM.F_REKON_MUTASI_EOD_FMB_SOSA_BPK,DWBI_DM.F_REKON_TRX_ANTAR_ERPBISAK_BPK,DWBI_DM.F_REKON_TRX_ANTAR_ERPSOSA_BPK,DWBI_DM.F_REKON_TRX_KAS_VS_MODAL_KERJA_BPK,DWBI_DM.F_REKON_COA_ERP_CBS_BPK,DWBI_DM.F_REKON_LOG_DATA_ERP_CBS_BPK,DWBI_DM.F_REKON_STATUS_KRYWN_HRIS_CBS_BPK,DWBI_DM.F_REKON_TRX_ANTAR_CBS_FMB_BPK,DWBI_DM.F_REKON_TRX_ANTAR_ERP_CBS_BPK,DWBI_DM.F_REKON_TRX_PAJAK_ERP_CBS_BPK estimate_only=yes logfile=estimate_table_REKON_BPK_21072023.log
```

```bash
cat/vim/vi expd_EDW_SIPU_BPK.par
```

Isi dari par
```bash
DUMPFILE=expdp_REKON_BPK_21072023_%U.dmp
LOGFILE=expdp_REKON_BPK_21072023.log
DIRECTORY=DATAPUMP
tables=DWBI_DM.F_REKON_CLAIM_TANGGUNGAN_BPK,
DWBI_DM.F_REKON_COA_ERP_FMB_BPK,
DWBI_DM.F_REKON_DATA_PEG_TANGGUNGAN_BPK,
DWBI_DM.F_REKON_IN_OUT_MODAL_KERJA_DTL_BPK,
DWBI_DM.F_REKON_LOG_DATA_FMB_SOSA_BPK,
DWBI_DM.F_REKON_LOG_DATA_SOSA_ERP_BPK,
DWBI_DM.F_REKON_MODAL_KERJA_EOD_BPK,
DWBI_DM.F_REKON_MUSNAH_BISAK_VS_ERP_BPK,
DWBI_DM.F_REKON_MUTASI_EOD_BPK,
DWBI_DM.F_REKON_MUTASI_EOD_FMB_SOSA_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERPBISAK_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERPSOSA_BPK,
DWBI_DM.F_REKON_TRX_KAS_VS_MODAL_KERJA_BPK,
DWBI_DM.F_REKON_COA_ERP_CBS_BPK,
DWBI_DM.F_REKON_LOG_DATA_ERP_CBS_BPK,
DWBI_DM.F_REKON_STATUS_KRYWN_HRIS_CBS_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_CBS_FMB_BPK,
DWBI_DM.F_REKON_TRX_ANTAR_ERP_CBS_BPK,
DWBI_DM.F_REKON_TRX_PAJAK_ERP_CBS_BPK
compression=all
cluster=N
parallel=4
```
